<html>
    <head>
        <title>Chatbot_GitHub</title>
        <meta http-equiv="Access-Control-Allow-Origin" content="*">
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    </head>
    <body>
        
        <div align="center">DevMerge BOT - V19</div>

        <script type='text/javascript'>
            
            // Pre-chat event listener. Add this somewhere inside the page where the 
            window.addEventListener("onEmbeddedMessagingReady", () => {
                console.log("Received the onEmbeddedMessagingReady event");
            
                // Fill these values through JavaScript to send data to Salesforce
                // All fields must be of type String and no longer than 100 characters
                embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
                    "UserId" : "1029488393", // CAT User Identifier (Unique Key)
                    "AccountId" : "8874788222", // CAT Customer Identifier (Unique Key)
                    "FirstName" : "Mario", // User First Name
                    "LastName" : "Rossi", // User Last Name
                    "Email" : "" // User Email
                });

                // Set ChatBot Specs
                let changeMap = new Map();
                changeMap.set("button", true);
                changeMap.set("z-index", true);
                console.log("Setting specs...");
                let setChatSpecs = setInterval(function(){
                    // Set z-index
                    if(changeMap.get("z-index") && document.getElementById("embedded-messaging") != null){
                        console.log("Setting z-index");
                        changeMap.set("z-index", false);
                        document.getElementById("embedded-messaging").style.zindex = "1000";
                    }
                    // Set button
                    if(changeMap.get("button") && document.getElementById("embeddedMessagingConversationButton") != null){
                        // Set icon
                        console.log("Setting button");
                        changeMap.set("button", false);
                        document.getElementById("embeddedMessagingIconContainer").style.display = "none";
                        document.getElementById("embeddedMessagingConversationButton").style.boxShadow = "";

                        let img = document.createElement('img');
                        img.src = "IconTop+TextBelow-LG@1x.png";
                        document.getElementById("embeddedMessagingIconContainer").appendChild(img);
                        // Set position
                        /*document.getElementById("embeddedMessagingConversationButton").style.bottom = "0";
                        document.getElementById("embeddedMessagingConversationButton").style.right = "0";
                        document.getElementById("embeddedMessagingConversationButton").style.top = "280px";*/
                        // Set size
                        document.getElementById("embeddedMessagingConversationButton").style.width = "48px";
                        document.getElementById("embeddedMessagingConversationButton").style.height = "48px";
                    }
                }, 50);
                setTimeout(function(){
                    clearInterval(setChatSpecs); 
                }, 5000);
            });
            
        	function initEmbeddedMessaging() {
        		try {
        			embeddedservice_bootstrap.settings.language = 'it'; // Set Language
                    embeddedservice_bootstrap.settings.widgetWidth = '50%'; // Set size
        
        			embeddedservice_bootstrap.init(
        				'00DDH00000057Ze',
        				'CGT_Bot_Web_Deployment',
        				'https://cgtspa--devmerge.sandbox.my.site.com/ESWCGTBotWebDeployment1697542037993',
        				{
        					scrt2URL: 'https://cgtspa--devmerge.sandbox.my.salesforce-scrt.com'
        				}
        			);
        		} catch (err) {
        			console.error('Error loading Embedded Messaging: ', err);
        		}
        	};
        </script>
        <script type='text/javascript' src='https://cgtspa--devmerge.sandbox.my.site.com/ESWCGTBotWebDeployment1697542037993/assets/js/bootstrap.min.js' onload='initEmbeddedMessaging()'></script>

    </body>
</html>
